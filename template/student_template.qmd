---
title: "Student Observations"
format:
  html:
    toc: true
    number-sections: true
params:
  semester: null
  nnid: null
  required_weeks: 9
  require_obs_per_week: 4
---

```{r setup-libraries, echo=F, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(arrow)
```

```{r load-data, echo=F}
# Load global dataset
d_all <- read_parquet("data/processed/full_data.parquet")

# Filter for this student and semester
ds <- d_all %>% filter(semester == params$semester, observedby_person_id == params$nnid)
```

# Student Overview

## **NNID:** `r params$nnid`  

**Semester:** `r params$semester`  
**Total observations:** `r nrow(ds)`  
**Weeks with observations:** `r sum(tapply(ds$site_id, ds$observation_week, length) > 0)`

---

## Weekly Observations

```{r echo=F}
ds %>%
  group_by(observation_week) %>%
  summarize(n_obs = n()) %>%
  ggplot(aes(x = observation_week, y = n_obs)) +
  geom_col(fill = "steelblue") +
  xlab("Week") +
  ylab("Number of Observations")
```

---

## Observations by Plant

The number of observations per individual plant monitored by this student.

```{r observations-by-plant, echo=F}
ds %>%
  group_by(plant_nickname) %>%
  summarize(n_obs = n()) %>%
  ggplot(aes(x = reorder(plant_nickname, n_obs), y = n_obs)) +
  geom_col(fill = "darkgreen") +
  coord_flip() +
  ylab("Observations") +
  xlab("Plant Nickname")
```
